<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>üîí Private Reels - Final Fixed</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Grand+Hotel&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">

    <style>
        /* --- 1. GLOBAL & RESET --- */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background-color: #000; color: white; font-family: 'Roboto', sans-serif; height: 100vh; height: 100dvh; width: 100vw; overflow: hidden; display: grid; place-items: center; }

        /* --- 2. LOGIN SCREEN --- */
        #loginScreen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: #000; display: flex; flex-direction: column; justify-content: center; align-items: center;
            z-index: 9999; padding: 20px; text-align: center;
        }
        #loginScreen h2 { font-family: 'Grand Hotel', cursive; font-size: 40px; margin-bottom: 30px; color: #ff4757; }
        .input-group { margin-bottom: 20px; width: 100%; max-width: 300px; text-align: left; }
        .input-group label { font-size: 12px; color: #888; margin-bottom: 5px; display: block; }
        .input-group input { width: 100%; padding: 12px; border-radius: 8px; border: 1px solid #333; background: #1a1a1a; color: white; font-size: 16px; outline: none; transition: border 0.3s; }
        .input-group input:focus { border-color: #ff4757; }
        .hint-text { color: #feca57; font-size: 14px; margin-top: 5px; display: none; }
        .login-btn { background: linear-gradient(45deg, #ff0050, #ff0080); color: white; border: none; padding: 12px 40px; border-radius: 25px; font-size: 16px; font-weight: bold; cursor: pointer; margin-top: 10px; box-shadow: 0 5px 15px rgba(255, 0, 80, 0.4); }
        .error-shake { animation: shake 0.4s ease-in-out; border-color: red !important; }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-10px); } 75% { transform: translateX(10px); } }

        /* --- 3. REELS APP --- */
        .app__phone {
            position: relative; height: 100%; width: 100%; max-width: 450px;
            background-color: black; overflow: hidden; margin: 0 auto;
            box-shadow: 0 0 20px rgba(0,0,0,0.5); opacity: 0; transition: opacity 1s ease;
        }
        @media (max-width: 500px) { .app__phone { max-width: 100%; box-shadow: none; border-radius: 0; } }
        .app__phone.unlocked { opacity: 1; }

        .app__header { position: absolute; top: 20px; left: 20px; z-index: 1000; pointer-events: none; }
        .app__header h1 { font-family: 'Grand Hotel', cursive; font-size: 30px; font-weight: 100; text-shadow: 1px 1px 3px rgba(0,0,0,0.5); }
        
        .app__videos { height: 100%; width: 100%; overflow-y: scroll; scroll-snap-type: y mandatory; scrollbar-width: none; scroll-behavior: smooth; -webkit-overflow-scrolling: touch; }
        .app__videos::-webkit-scrollbar { display: none; }
        
        .video { position: relative; height: 100%; width: 100%; background-color: #000; scroll-snap-align: start; scroll-snap-stop: always; touch-action: manipulation; }
        .video__player { width: 100%; height: 100%; object-fit: cover; opacity: 0; transition: opacity 0.5s ease; }
        .video__player.playing { opacity: 1; }

        .video-loader { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 40px; height: 40px; border: 4px solid rgba(255,255,255,0.3); border-top: 4px solid white; border-radius: 50%; animation: spin 1s linear infinite; z-index: 5; display: none; }
        .video.loading .video-loader { display: block; }
        @keyframes spin { 0% { transform: translate(-50%, -50%) rotate(0deg); } 100% { transform: translate(-50%, -50%) rotate(360deg); } }
        
        .volume-icon { position: absolute; top: 20px; right: 20px; width: 35px; height: 35px; background: rgba(0, 0, 0, 0.6); backdrop-filter: blur(2px); border-radius: 50%; display: flex; justify-content: center; align-items: center; font-size: 16px; opacity: 0; transition: opacity 0.2s ease; pointer-events: none; z-index: 200; }
        .love-icon { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0); width: 100px; height: 100px; opacity: 0; pointer-events: none; z-index: 10; animation: live-beat 1s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; filter: drop-shadow(0 5px 15px rgba(0,0,0,0.4)); }
        @keyframes live-beat { 0% { opacity: 0; transform: translate(-50%, -50%) scale(0) rotate(-15deg); } 15% { opacity: 1; transform: translate(-50%, -50%) scale(1.4) rotate(5deg); } 60% { opacity: 1; transform: translate(-50%, -50%) scale(1) rotate(0deg); } 100% { opacity: 0; transform: translate(-50%, -50%) scale(0) rotate(0deg); } }
        
        /* UI Elements */
        .videoFooter { position: absolute; bottom: 20px; left: 15px; color: white; display: flex; align-items: flex-end; width: 75%; z-index: 30; }
        .videoFooter__text { flex: 1; }
        .videoFooter__text h3 { font-size: 14px; font-weight: 700; margin-bottom: 5px; text-shadow: 1px 1px 3px rgba(0,0,0,0.5); display: flex; align-items: center; }
        .videoFooter__text p { font-size: 14px; font-weight: 400; text-shadow: 1px 1px 3px rgba(0,0,0,0.5); line-height: 1.3; }
        .videoFooter__ticker { font-size: 12px; margin-top: 10px; opacity: 0.9; display: flex; align-items: center; }
        .music-ticker-container { overflow: hidden; white-space: nowrap; width: 150px; margin-left: 5px; mask-image: linear-gradient(to right, transparent, black 10%, black 90%, transparent); -webkit-mask-image: linear-gradient(to right, transparent, black 10%, black 90%, transparent); }
        .music-ticker-text { display: inline-block; animation: scrollText 5s linear infinite; padding-left: 100%; }
        @keyframes scrollText { 0% { transform: translate(0, 0); } 100% { transform: translate(-100%, 0); } }
        
        /* SIDEBAR (Now contains the disc for perfect alignment) */
        .videoSidebar { 
            position: absolute; 
            bottom: 30px; 
            right: 10px; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            gap: 22px; /* Consistent spacing between buttons and disc */
            z-index: 30; 
        }
        .sidebar__button { display: flex; flex-direction: column; align-items: center; cursor: pointer; }
        .sidebar__button span { font-size: 28px; margin-bottom: 3px; text-shadow: 1px 1px 3px rgba(0,0,0,0.5); }
        .sidebar__button p { font-size: 12px; font-weight: 500; }
        .liked { color: #ff3b3b; animation: pulse 0.3s ease-in-out; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.3); } 100% { transform: scale(1); } }
        .follow-btn { border: 1px solid white; background: transparent; color: white; border-radius: 4px; padding: 2px 8px; font-size: 11px; font-weight: 600; margin-left: 10px; cursor: pointer; text-transform: uppercase; }
        .follow-btn.following { background: white; color: black; border: 1px solid white; }
        .speed-indicator { position: absolute; top: 10%; left: 50%; transform: translateX(-50%); background: rgba(0, 0, 0, 0.6); padding: 5px 15px; border-radius: 20px; font-size: 14px; font-weight: bold; opacity: 0; transition: opacity 0.2s; pointer-events: none; z-index: 25; }

        /* VINYL DISC (Now inside sidebar, no absolute pos needed) */
        .music-disc { 
            width: 45px; height: 45px; 
            background: #222; border-radius: 50%; border: 2px solid #333; 
            display: flex; justify-content: center; align-items: center; 
            overflow: hidden; animation: spin 4s linear infinite; 
            margin-top: 10px; /* Extra space from the last button */
        }
        .music-disc img { width: 100%; height: 100%; object-fit: cover; border: 6px solid #111; border-radius: 50%; }
        .video.paused .music-disc { animation-play-state: paused; }
        .verified-badge { width: 14px; height: 14px; margin-left: 5px; fill: #45aaf2; }
        
        .progress-container { position: absolute; bottom: 0; left: 0; width: 100%; height: 2px; background: rgba(255,255,255,0.2); z-index: 50; }
        .progress-bar { height: 100%; width: 0%; background: #ff4757; transition: width 0.1s linear; }

        /* Sheets */
        .bottom-sheet-wrapper { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 2000; display: none; }
        .bottom-sheet-wrapper.active { display: block; }
        .bottom-sheet { position: absolute; bottom: -100%; left: 0; width: 100%; background-color: #121212; border-radius: 15px 15px 0 0; transition: bottom 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); display: flex; flex-direction: column; border-top: 1px solid #333; cursor: default; }
        .bottom-sheet-wrapper.active .bottom-sheet { bottom: 0; }
        
        .share-sheet { height: auto; padding-bottom: 20px; }
        .share-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; padding: 20px; }
        .share-item { display: flex; flex-direction: column; align-items: center; gap: 8px; font-size: 11px; color: #ccc; cursor: pointer; text-decoration: none;} 
        .share-icon { width: 50px; height: 50px; border-radius: 50%; background: #333; display: flex; justify-content: center; align-items: center; font-size: 24px; transition: background 0.2s; color: white; }
        .share-item:active .share-icon { background: #555; }

        .comments-sheet { height: 70%; }
        .sheet-header { display: flex; justify-content: center; align-items: center; padding: 15px; border-bottom: 1px solid #333; font-weight: bold; font-size: 14px; position: relative; }
        .sheet-close { position: absolute; right: 15px; cursor: pointer; font-size: 20px; }
        .comments-list { flex: 1; overflow-y: auto; padding: 10px; }
        .comment-row { display: flex; align-items: flex-start; margin-bottom: 15px; }
        .comment-avatar { width: 32px; height: 32px; border-radius: 50%; margin-right: 10px; object-fit: cover; background-color: #333; -webkit-touch-callout: none; -webkit-user-select: none; user-select: none; cursor: pointer; }
        .comment-content { flex: 1; font-size: 13px; }
        .comment-username { font-weight: bold; margin-right: 5px; color: #f1f1f1; }
        .comment-text { color: #ddd; line-height: 1.3; }
        .comment-meta { font-size: 11px; color: #888; margin-top: 4px; display: flex; gap: 10px; }
        .comment-like-btn { padding: 0 5px; cursor: pointer; display: flex; flex-direction: column; align-items: center; }
        .comment-like-btn span { font-size: 12px; }
        .comment-like-heart { font-size: 12px; margin-bottom: 2px; }
        .comment-liked { color: #ff3b3b; }
        .comment-input-area { padding: 10px; border-top: 1px solid #333; display: flex; align-items: center; background: #121212; }
        .comment-input-area input { flex: 1; background: #222; border: none; padding: 10px; border-radius: 20px; color: white; outline: none; }
        .comment-post-btn { color: #0095f6; font-weight: bold; margin-left: 10px; font-size: 14px; cursor: pointer; }

        /* Zoom Overlay */
        #avatarZoomOverlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.85); backdrop-filter: blur(5px); z-index: 5000; display: flex; justify-content: center; align-items: center; opacity: 0; pointer-events: none; transition: opacity 0.3s; }
        #avatarZoomOverlay.active { opacity: 1; pointer-events: auto; }
        #zoomedAvatar { width: 300px; height: 300px; border-radius: 50%; object-fit: cover; box-shadow: 0 0 30px rgba(255, 255, 255, 0.2); transform: scale(0.5); transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        #avatarZoomOverlay.active #zoomedAvatar { transform: scale(1); }

    </style>
</head>
<body>

    <div id="loginScreen">
        <h2>Security Check</h2>
        <div class="input-group">
            <label>Tera, Jaiuu ka dia hua naam</label>
            <input type="text" id="pass1" placeholder="Type here..." autocomplete="off">
            <p class="hint-text" id="hint1">Hint: üòã</p>
        </div>
        <div class="input-group">
            <label>Tune, Jaiuu ko dia hua naam</label>
            <input type="text" id="pass2" placeholder="Type here..." autocomplete="off">
            <p class="hint-text" id="hint2">Hint: ü¶á</p>
        </div>
        <button class="login-btn" onclick="checkLogin()">Login</button>
    </div>

    <div class="app__phone" id="mainApp">
        <div class="app__header"><h1>Reels</h1></div>
        <div class="app__videos" id="videoContainer"></div>

        <div class="bottom-sheet-wrapper" id="commentsWrapper" onclick="closeSheet('commentsWrapper')">
            <div class="bottom-sheet comments-sheet" onclick="event.stopPropagation()">
                <div class="sheet-header">Comments <span class="sheet-close" onclick="closeSheet('commentsWrapper')">√ó</span></div>
                <div class="comments-list" id="commentsList"></div>
                <div class="comment-input-area">
                    <input type="text" placeholder="Add a comment..." id="commentInput">
                    <div class="comment-post-btn" onclick="postComment()">Post</div>
                </div>
            </div>
        </div>

        <div class="bottom-sheet-wrapper" id="shareWrapper" onclick="closeSheet('shareWrapper')">
            <div class="bottom-sheet share-sheet" onclick="event.stopPropagation()">
                <div class="sheet-header">Share to... <span class="sheet-close" onclick="closeSheet('shareWrapper')">√ó</span></div>
                <div class="share-grid">
                    <div class="share-item" onclick="copyLink()">
                        <div class="share-icon">üîó</div><span>Copy Link</span>
                    </div>
                    <div class="share-item" onclick="shareToWhatsApp()">
                        <div class="share-icon" style="background:#25D366">üí¨</div><span>WhatsApp</span>
                    </div>
                    <div class="share-item" onclick="shareToTelegram()">
                        <div class="share-icon" style="background:#0088cc">‚úàÔ∏è</div><span>Telegram</span>
                    </div>
                    <div class="share-item" onclick="shareToTwitter()">
                        <div class="share-icon" style="background:#1DA1F2">üê¶</div><span>Twitter</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="avatarZoomOverlay"><img src="" id="zoomedAvatar" alt="Zoomed Profile"></div>

    <script>
        /* ==========================================
           SECURITY
           ========================================== */
        const correct1 = "boondikaladdu"; const correct2 = "chamkadad"; let attemptCount = 0;
        function checkLogin() {
            const in1 = document.getElementById('pass1'), in2 = document.getElementById('pass2');
            if (in1.value.trim().toLowerCase() === correct1 && in2.value.trim().toLowerCase() === correct2) { unlockApp(); }
            else {
                attemptCount++; in1.classList.add('error-shake'); in2.classList.add('error-shake');
                setTimeout(() => { in1.classList.remove('error-shake'); in2.classList.remove('error-shake'); }, 400);
                if (attemptCount >= 3) { document.getElementById('hint1').style.display = 'block'; document.getElementById('hint2').style.display = 'block'; }
            }
        }
        function unlockApp() { document.getElementById('loginScreen').style.display = 'none'; document.getElementById('mainApp').classList.add('unlocked'); const f = document.querySelector('video'); if(f) f.play().catch(e=>{}); }
        function lockApp() {
            document.getElementById('loginScreen').style.display = 'flex'; document.getElementById('mainApp').classList.remove('unlocked');
            document.getElementById('pass1').value = ''; document.getElementById('pass2').value = '';
            document.querySelectorAll('video').forEach(v => v.pause());
            document.getElementById('commentsWrapper').classList.remove('active'); document.getElementById('shareWrapper').classList.remove('active'); document.getElementById('avatarZoomOverlay').classList.remove('active');
        }
        document.addEventListener('visibilitychange', () => { if (document.hidden) lockApp(); });

        /* ==========================================
           DATA
           ========================================== */
        let globalMuted = true; 
        const glossyColors = ['#ff4757', '#ff9ff3', '#feca57', '#ff9f43', '#00d2d3', '#54a0ff', '#5f27cd'];

        const videoPlaylist = [
            {
                id: 1, filename: 'video1.mp4', username: '@neon_vibes', userProfile: 'https://i.pravatar.cc/150?img=1', isVerified: true, description: 'Secure Login Active! üîí', likes: 12050, song: 'Original Audio', comments: [{ user: 'alex', profile: 'https://i.pravatar.cc/150?img=3', text: 'Love the disc!', likes: 2, liked: false }]
            },
            {
                id: 2, filename: 'video2.mp4', username: '@nature', userProfile: 'https://i.pravatar.cc/150?img=5', isVerified: false, description: 'Double tap to Like!', likes: 450, song: 'Birds', comments: []
            },
            {
                id: 3, filename: 'video3.mp4', username: '@ocean', userProfile: 'https://i.pravatar.cc/150?img=8', isVerified: true, description: 'Single tap to mute/unmute', likes: 22100, song: 'Waves', comments: []
            },
             {
                id: 4, filename: 'video4.mp4', username: '@gym_rat', userProfile: 'https://i.pravatar.cc/150?img=12', isVerified: false, description: 'Fitness Motivation üèãÔ∏è‚Äç‚ôÇÔ∏è', likes: 10300, song: 'Phonk', comments: []
            }
        ];

        /* ==========================================
           GENERATE UI
           ========================================== */
        const container = document.getElementById('videoContainer');
        const verifiedSVG = `<svg class="verified-badge" viewBox="0 0 24 24"><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2zm-1.9 14.7L6.6 13l1.4-1.4 2.1 2.1 5.3-5.3 1.4 1.4-6.7 6.9z"></path></svg>`;

        videoPlaylist.forEach((data, index) => {
            const badge = data.isVerified ? verifiedSVG : '';
            const videoHTML = `
            <div class="video loading" id="reel-${index}">
                <video class="video__player" data-src="${data.filename}" loop muted playsinline preload="metadata"></video>
                <div class="progress-container"><div class="progress-bar"></div></div>
                <div class="video-loader"></div>
                <div class="volume-icon">üîá</div>
                <div class="speed-indicator">2x Speed &raquo;</div>
                <div class="videoFooter">
                    <div class="videoFooter__text">
                        <h3>${data.username} ${badge} <button class="follow-btn" onclick="toggleFollow(this, event)">Follow</button></h3>
                        <p>${data.description}</p>
                        <div class="videoFooter__ticker"><span>üéµ</span><div class="music-ticker-container"><span class="music-ticker-text">${data.song}</span></div></div>
                    </div>
                </div>
                
                <div class="videoSidebar">
                    <div class="sidebar__button like-btn" onclick="toggleLikeSide(this, event)">
                        <span>ü§ç</span> <p>${data.likes}</p>
                    </div>
    